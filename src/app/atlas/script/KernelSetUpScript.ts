import { Host } from "@atlas/class/host/Host.ts";
import { ethers as Ethers } from "ethers";

class KernelSetUpScript {
    private constructor() {}
    protected static _rpcUrl: string = "https://polygon-rpc.com";
    protected static _privateKey: Host.ISecret = new Host.Secret("polygonPrivateKey");

    public static async run(): Promise<void> {
        if (this._privateKey.resolve().none) {
            console.log("KernelSetUpScript::MissingPrivateKey");
            return;
        }
        /**
         * @note For one reason or another this does not deploy
         *       so the bytecode has been pre compiled.
         */
        const nodeDeployerAddress: string = ((await new Host.ConstructorTransaction({
            rpcUrl: this._rpcUrl,
            privateKey: this._privateKey.resolve().unwrap(),
            gasPrice: "standard",
            bytecode: "0x6080604052348015600e575f80fd5b5033601d81602260201b60201c565b5060e3565b5f805f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050815f806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b615d15806100f05f395ff3fe608060405234801561000f575f80fd5b506004361061004a575f3560e01c8063715018a61461004e578063775c300c146100585780638da5cb5b14610076578063f2fde38b14610094575b5f80fd5b6100566100b0565b005b6100606100ba565b60405161006d91906103ff565b60405180910390f35b61007e610197565b60405161008b91906103ff565b60405180910390f35b6100ae60048036038101906100a99190610446565b6101a5565b005b6100b86101b1565b565b5f6100c36101c4565b5f6040516100d0906103b3565b604051809103905ff0801580156100e9573d5f803e3d5ffd5b5090508073ffffffffffffffffffffffffffffffffffffffff1663f2fde38b610110610197565b6040518263ffffffff1660e01b815260040161012c91906103ff565b5f604051808303815f87803b158015610143575f80fd5b505af1158015610155573d5f803e3d5ffd5b505050507f8caefb0c150c4d097593deb07f0591b0225f67392b0ae76f2df209b8be37b82a8160405161018891906103ff565b60405180910390a18091505090565b5f6101a0610242565b905090565b6101ae81610269565b50565b6101b96101c4565b6101c25f6102eb565b565b6101cc6103ac565b73ffffffffffffffffffffffffffffffffffffffff166101ea610197565b73ffffffffffffffffffffffffffffffffffffffff1614610240576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610237906104cb565b60405180910390fd5b565b5f805f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6102716101c4565b5f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036102df576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102d690610559565b60405180910390fd5b6102e8816102eb565b50565b5f805f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050815f806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f33905090565b6157688061057883390190565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6103e9826103c0565b9050919050565b6103f9816103df565b82525050565b5f6020820190506104125f8301846103f0565b92915050565b5f80fd5b610425816103df565b811461042f575f80fd5b50565b5f813590506104408161041c565b92915050565b5f6020828403121561045b5761045a610418565b5b5f61046884828501610432565b91505092915050565b5f82825260208201905092915050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e65725f82015250565b5f6104b5602083610471565b91506104c082610481565b602082019050919050565b5f6020820190508181035f8301526104e2816104a9565b9050919050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f20615f8201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b5f610543602683610471565b915061054e826104e9565b604082019050919050565b5f6020820190508181035f83015261057081610537565b905091905056fe608060405234801561000f575f80fd5b505f600c67ffffffffffffffff81111561002c5761002b611893565b5b60405190808252806020026020018201604052801561005a5781602001602082028036833780820191505090505b5090505f632c40805960e01b828280610072906118f6565b9350815181106100855761008461193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681525050639142376560e01b8282806100e5906118f6565b9350815181106100f8576100f761193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250506101757fbd02b73c0000000000000000000000000000000000000000000000000000000060016107a660201b60201c565b631f931c1c60e01b828280610189906118f6565b93508151811061019c5761019b61193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250506102197f1f931c1c0000000000000000000000000000000000000000000000000000000060016107a660201b60201c565b637a0ed62760e01b82828061022d906118f6565b9350815181106102405761023f61193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152505063adfca15e60e01b8282806102a0906118f6565b9350815181106102b3576102b261193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250506352ef6b2c60e01b828280610313906118f6565b9350815181106103265761032561193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152505063cdffacc660e01b828280610386906118f6565b9350815181106103995761039861193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250506104167f48e2b0930000000000000000000000000000000000000000000000000000000060016107a660201b60201c565b6301ffc9a760e01b82828061042a906118f6565b93508151811061043d5761043c61193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250506104ba7f01ffc9a70000000000000000000000000000000000000000000000000000000060016107a660201b60201c565b638da5cb5b60e01b8282806104ce906118f6565b9350815181106104e1576104e061193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681525050638ab5150a60e01b828280610541906118f6565b9350815181106105545761055361193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152505063f2fde38b60e01b8282806105b4906118f6565b9350815181106105c7576105c661193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250506379ba509760e01b828280610627906118f6565b93508151811061063a5761063961193d565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250506106b77f7f5828d00000000000000000000000000000000000000000000000000000000060016107a660201b60201c565b5f600167ffffffffffffffff8111156106d3576106d2611893565b5b60405190808252806020026020018201604052801561070c57816020015b6106f961184c565b8152602001906001900390816106f15790505b50905060405180606001604052803073ffffffffffffffffffffffffffffffffffffffff1681526020015f60028111156107495761074861196a565b5b815260200184815250815f815181106107655761076461193d565b5b602002602001018190525061078f815f60405180602001604052805f81525061087d60201b60201c565b61079e33610ac660201b60201c565b505050611d18565b63ffffffff60e01b827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191603610805576040517fb0a19dd500000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b80610814610b9860201b60201c565b5f015f847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205f6101000a81548160ff0219169083151502179055505050565b5f61088c610bc460201b60201c565b90505f816001015f9054906101000a900461ffff1661ffff1690505f8190505f806007831611156108d257836002015f600384901c81526020019081526020015f205490505b5f5b8751811015610a23575f8882815181106108f1576108f061193d565b5b602002602001015190505f816020015190505f82604001515103610941576040517feb6c3aeb00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f60028111156109545761095361196a565b5b8160028111156109675761096661196a565b5b0361098b5761097e87868685610bf060201b60201c565b8095508196505050610a14565b6001600281111561099f5761099e61196a565b5b8160028111156109b2576109b161196a565b5b036109cc576109c78783610efc60201b60201c565b610a13565b6002808111156109df576109de61196a565b5b8160028111156109f2576109f161196a565b5b03610a1257610a09878686856111a960201b60201c565b80955081965050505b5b5b505080806001019150506108d4565b50828214610a4a5781846001015f6101000a81548161ffff021916908361ffff1602179055505b5f600783161115610a725780846002015f600385901c81526020019081526020015f20819055505b7f8faa70878671ccd212d20771b795c50af8fd3ff6cf27f4bde57e5d4de0aeb673878787604051610aa593929190611c85565b60405180910390a1610abd868661166560201b60201c565b50505050505050565b5f610ad561180f60201b60201c565b90508173ffffffffffffffffffffffffffffffffffffffff16815f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a381815f015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505050565b5f807ffc606c433378e3a7e0a6a531deac289b66caa1b4aa8554fd4ab2c6f1570f92d890508091505090565b5f807f177481ac65e4292921c69f62d1cc7f57541261e5d61c8175cf4e36a01c9bfc9390508091505090565b5f80610c1a835f015173ffffffffffffffffffffffffffffffffffffffff1661183b60201b60201c565b15610c8c573073ffffffffffffffffffffffffffffffffffffffff16835f015173ffffffffffffffffffffffffffffffffffffffff1603610c87576040517fe983573100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b610cf5565b3073ffffffffffffffffffffffffffffffffffffffff16835f015173ffffffffffffffffffffffffffffffffffffffff1614610cf4576040517ff77172ac00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5b5f5b836040015151811015610eec575f84604001518281518110610d1c57610d1b61193d565b5b602002602001015190505f885f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205490505f73ffffffffffffffffffffffffffffffffffffffff168160601c73ffffffffffffffffffffffffffffffffffffffff1614610de2576040517f92474ee200000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b875f1b865f015160601b6bffffffffffffffffffffffff191617895f015f847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f20819055505f600560078a16901b905080837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916901c817fffffffff000000000000000000000000000000000000000000000000000000005f1b901c19891617975060e08103610ed457878a6002015f60038c901c81526020019081526020015f20819055505f801b97505b88806001019950505050508080600101915050610cf7565b5084849150915094509492505050565b610f24815f015173ffffffffffffffffffffffffffffffffffffffff1661183b60201b60201c565b610f5a576040517ff77172ac00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f5b8160400151518110156111a4575f82604001518281518110610f8157610f8061193d565b5b602002602001015190505f845f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205490505f8160601c90505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff160361104b576040517f6fc4b52e00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b3073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036110b0576040517fe983573100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b845f015173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603611118576040517f617557e600000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b845f015160601b6bffffffffffffffffffffffff19166bffffffffffffffffffffffff5f1b831617865f015f857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f20819055505050508080600101915050610f5c565b505050565b5f805f73ffffffffffffffffffffffffffffffffffffffff16835f015173ffffffffffffffffffffffffffffffffffffffff1614611213576040517feacd242400000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f600386901c90505f6007871690505f5b85604001515181101561164a575f866040015182815181106112495761124861193d565b5b602002602001015190505f8a5f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205490505f73ffffffffffffffffffffffffffffffffffffffff168160601c73ffffffffffffffffffffffffffffffffffffffff160361130f576040517f6fc4b52e00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b3073ffffffffffffffffffffffffffffffffffffffff168160601c73ffffffffffffffffffffffffffffffffffffffff1603611377576040517fe983573100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f801b89036113a8578480600190039550508a6002015f8681526020019081526020015f20549850600793506113b2565b8380600190039450505b5f805f600587901b8c901b9250847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916146114cb578d5f015f847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f20546bffffffffffffffffffffffff19166bffffffffffffffffffffffff5f1b8516178e5f015f857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f20819055505b8d5f015f867bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205f90555f845f1c61ffff169050600381901c9250600560078216901b9150508782146115c5575f8e6002015f8481526020019081526020015f2054905081847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916901c827fffffffff000000000000000000000000000000000000000000000000000000005f1b901c198216179050808f6002015f8581526020019081526020015f208190555050611615565b80837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916901c817fffffffff000000000000000000000000000000000000000000000000000000005f1b901c198d16179b505b5f8703611638578d6002015f8981526020019081526020015f205f90555f801b9b505b50505050508080600101915050611224565b5080600383901b179650868693509350505094509492505050565b5f81511415155f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16141515146116d3576040517f26df4ccd00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161461180b573073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16146117955761175e8273ffffffffffffffffffffffffffffffffffffffff1661183b60201b60201c565b611794576040517ff77172ac00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5b5f8273ffffffffffffffffffffffffffffffffffffffff16826040516117bb9190611d02565b5f60405180830381855af49150503d805f81146117f3576040519150601f19603f3d011682016040523d82523d5f602084013e6117f8565b606091505b5050905080611809573d5f803e3d5ffd5b505b5050565b5f807f8a22373512790c48b83a1fe2efdd2888d4a917bcdc24d0adf63e60f67168046090508091505090565b5f80823b90505f8111915050919050565b60405180606001604052805f73ffffffffffffffffffffffffffffffffffffffff1681526020015f60028111156118865761188561196a565b5b8152602001606081525090565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f819050919050565b5f611900826118ed565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203611932576119316118c0565b5b600182019050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602160045260245ffd5b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6119e9826119c0565b9050919050565b6119f9816119df565b82525050565b60038110611a1057611a0f61196a565b5b50565b5f819050611a20826119ff565b919050565b5f611a2f82611a13565b9050919050565b611a3f81611a25565b82525050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b5f7fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b611aa281611a6e565b82525050565b5f611ab38383611a99565b60208301905092915050565b5f602082019050919050565b5f611ad582611a45565b611adf8185611a4f565b9350611aea83611a5f565b805f5b83811015611b1a578151611b018882611aa8565b9750611b0c83611abf565b925050600181019050611aed565b5085935050505092915050565b5f606083015f830151611b3c5f8601826119f0565b506020830151611b4f6020860182611a36565b5060408301518482036040860152611b678282611acb565b9150508091505092915050565b5f611b7f8383611b27565b905092915050565b5f602082019050919050565b5f611b9d82611997565b611ba781856119a1565b935083602082028501611bb9856119b1565b805f5b85811015611bf45784840389528151611bd58582611b74565b9450611be083611b87565b925060208a01995050600181019050611bbc565b50829750879550505050505092915050565b611c0f816119df565b82525050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f611c5782611c15565b611c618185611c1f565b9350611c71818560208601611c2f565b611c7a81611c3d565b840191505092915050565b5f6060820190508181035f830152611c9d8186611b93565b9050611cac6020830185611c06565b8181036040830152611cbe8184611c4d565b9050949350505050565b5f81905092915050565b5f611cdc82611c15565b611ce68185611cc8565b9350611cf6818560208601611c2f565b80840191505092915050565b5f611d0d8284611cd2565b915081905092915050565b613a4380611d255f395ff3fe60806040526004361061010c575f3560e01c80637ab7f1ef11610094578063adfca15e11610063578063adfca15e146103f6578063b909eb8b14610432578063c5fda2ac1461046e578063cdffacc6146104aa578063f2fde38b146104e657610113565b80637ab7f1ef1461033e5780638ab5150a1461037a5780638da5cb5b146103a457806391423765146103ce57610113565b80632c408059116100db5780632c4080591461026e57806352ef6b2c1461029857806359bc2249146102c257806379ba5097146102fe5780637a0ed6271461031457610113565b806301ffc9a7146101925780631f931c1c146101ce57806327c48c4f146101f65780632a1b8f9b1461023257610113565b3661011357005b5f61011c61050e565b905061013d8173ffffffffffffffffffffffffffffffffffffffff1661051c565b610173576040517f87c9fc3400000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b365f80375f80365f845af43d5f803e805f811461018e573d5ff35b3d5ffd5b34801561019d575f80fd5b506101b860048036038101906101b39190612cfa565b61052d565b6040516101c59190612d3f565b60405180910390f35b3480156101d9575f80fd5b506101f460048036038101906101ef9190612e68565b61053e565b005b348015610201575f80fd5b5061021c60048036038101906102179190613041565b61060b565b6040516102299190612d3f565b60405180910390f35b34801561023d575f80fd5b506102586004803603810190610253919061309b565b61068a565b6040516102659190612d3f565b60405180910390f35b348015610279575f80fd5b50610282610707565b60405161028f91906130d5565b60405180910390f35b3480156102a3575f80fd5b506102ac610715565b6040516102b991906131a5565b60405180910390f35b3480156102cd575f80fd5b506102e860048036038101906102e3919061309b565b610724565b6040516102f59190612d3f565b60405180910390f35b348015610309575f80fd5b506103126107a1565b005b34801561031f575f80fd5b50610328610817565b6040516103359190613371565b60405180910390f35b348015610349575f80fd5b50610364600480360381019061035f919061309b565b610826565b6040516103719190612d3f565b60405180910390f35b348015610385575f80fd5b5061038e6108a3565b60405161039b91906130d5565b60405180910390f35b3480156103af575f80fd5b506103b86108b1565b6040516103c591906130d5565b60405180910390f35b3480156103d9575f80fd5b506103f460048036038101906103ef919061309b565b6108bf565b005b348015610401575f80fd5b5061041c6004803603810190610417919061309b565b610937565b60405161042991906133fd565b60405180910390f35b34801561043d575f80fd5b5061045860048036038101906104539190613041565b610949565b6040516104659190612d3f565b60405180910390f35b348015610479575f80fd5b50610494600480360381019061048f919061341d565b6109c8565b6040516104a19190612d3f565b60405180910390f35b3480156104b5575f80fd5b506104d060048036038101906104cb9190612cfa565b610a45565b6040516104dd91906130d5565b60405180910390f35b3480156104f1575f80fd5b5061050c6004803603810190610507919061309b565b610a56565b005b5f610517610ace565b905090565b5f80823b90505f8111915050919050565b5f61053782610b1a565b9050919050565b610546610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146105aa576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6106048585906105ba91906135bd565b8484848080601f0160208091040260200160405190810160405280939291908181526020018383808284375f81840152601f19601f82011690508083019250505050505050610bb6565b5050505050565b5f610614610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610678576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6106828383610de1565b905092915050565b5f610693610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146106f7576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b61070082610ef3565b9050919050565b5f610710610f7e565b905090565b606061071f610faf565b905090565b5f61072d610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610791576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b61079a826111f4565b9050919050565b6107a961127e565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461080d576040517fefd1052d00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6108156112ae565b565b60606108216112e5565b905090565b5f61082f610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610893576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b61089c8261181a565b9050919050565b5f6108ac61127e565b905090565b5f6108ba610b86565b905090565b6108c7610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461092b576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b610934816118a5565b50565b6060610942826118f1565b9050919050565b5f610952610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146109b6576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6109c08383611afa565b905092915050565b5f6109d1610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610a35576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b610a3e82611c0b565b9050919050565b5f610a4f82611d1c565b9050919050565b610a5e610b86565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610ac2576040517f2f7a8ee100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b610acb81611d7f565b50565b5f610ad7611d8b565b90505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610b1757610b14610f7e565b90505b90565b5f610b23611e32565b5f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205f9054906101000a900460ff169050919050565b5f610b8f611e5e565b5f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b5f610bbf611e8a565b90505f816001015f9054906101000a900461ffff1661ffff1690505f8190505f80600783161115610c0557836002015f600384901c81526020019081526020015f205490505b5f5b8751811015610d44575f888281518110610c2457610c236135d1565b5b602002602001015190505f816020015190505f82604001515103610c74576040517feb6c3aeb00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f6002811115610c8757610c866135fe565b5b816002811115610c9a57610c996135fe565b5b03610cb857610cab87868685611eb6565b8095508196505050610d35565b60016002811115610ccc57610ccb6135fe565b5b816002811115610cdf57610cde6135fe565b5b03610cf357610cee87836121bc565b610d34565b600280811115610d0657610d056135fe565b5b816002811115610d1957610d186135fe565b5b03610d3357610d2a87868685612463565b80955081965050505b5b5b50508080600101915050610c07565b50828214610d6b5781846001015f6101000a81548161ffff021916908361ffff1602179055505b5f600783161115610d935780846002015f600385901c81526020019081526020015f20819055505b7f8faa70878671ccd212d20771b795c50af8fd3ff6cf27f4bde57e5d4de0aeb673878787604051610dc6939291906137d9565b60405180910390a1610dd8868661291f565b50505050505050565b5f8060019050610def612c1e565b84815f019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250508181602001906002811115610e3e57610e3d6135fe565b5b90816002811115610e5257610e516135fe565b5b815250508381604001819052505f600167ffffffffffffffff811115610e7b57610e7a612f09565b5b604051908082528060200260200182016040528015610eb457816020015b610ea1612c1e565b815260200190600190039081610e995790505b50905081815f81518110610ecb57610eca6135d1565b5b60200260200101819052505f6060610ee4838383610bb6565b60019550505050505092915050565b5f808290505f8173ffffffffffffffffffffffffffffffffffffffff16636e25b9786040518163ffffffff1660e01b81526004015f60405180830381865afa158015610f41573d5f803e3d5ffd5b505050506040513d5f823e3d601f19601f82011682018060405250810190610f6991906138c5565b9050610f758482611afa565b92505050919050565b5f610f87611e8a565b6003015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60605f610fba611e8a565b9050806001015f9054906101000a900461ffff1661ffff1667ffffffffffffffff811115610feb57610fea612f09565b5b6040519080825280602002602001820160405280156110195781602001602082028036833780820191505090505b5091505f805f5b836001015f9054906101000a900461ffff1661ffff168210156111ea575f846002015f8381526020019081526020015f205490505f5b60088110156111d557838061106a90613942565b945050856001015f9054906101000a900461ffff1661ffff1684116111d5575f600582901b83901b90505f875f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205460601c90505f805b88811015611159578a8181518110611109576111086135d1565b5b602002602001015173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff160361114c5760019150611159565b80806001019150506110ee565b508015611168575050506111c8565b818a898151811061117c5761117b6135d1565b5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505087806111c190613942565b9850505050505b8080600101915050611056565b505080806111e290613942565b915050611020565b5081845250505090565b5f808290505f8173ffffffffffffffffffffffffffffffffffffffff16636e25b9786040518163ffffffff1660e01b81526004015f60405180830381865afa158015611242573d5f803e3d5ffd5b505050506040513d5f823e3d601f19601f8201168201806040525081019061126a91906138c5565b905061127581611c0b565b92505050919050565b5f611287612ac3565b5f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6112b733612aef565b6112bf612ac3565b5f015f6101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055565b60605f6112f0611e8a565b9050806001015f9054906101000a900461ffff1661ffff1667ffffffffffffffff81111561132157611320612f09565b5b60405190808252806020026020018201604052801561135a57816020015b611347612c65565b81526020019060019003908161133f5790505b5091505f816001015f9054906101000a900461ffff1661ffff1667ffffffffffffffff81111561138d5761138c612f09565b5b6040519080825280602002602001820160405280156113bb5781602001602082028036833780820191505090505b5090505f805f5b846001015f9054906101000a900461ffff1661ffff168210156117af575f856002015f8381526020019081526020015f205490505f5b600881101561179a57838061140c90613942565b945050866001015f9054906101000a900461ffff1661ffff16841161179a575f600582901b83901b90505f885f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205460601c90505f805b888110156115f4578273ffffffffffffffffffffffffffffffffffffffff168c82815181106114c2576114c16135d1565b5b60200260200101515f015173ffffffffffffffffffffffffffffffffffffffff16036115e757838c82815181106114fc576114fb6135d1565b5b6020026020010151602001518b838151811061151b5761151a6135d1565b5b602002602001015160ff1681518110611537576115366135d1565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152505060ff8a8281518110611598576115976135d1565b5b602002602001015160ff16106115ac575f80fd5b8981815181106115bf576115be6135d1565b5b6020026020010180518091906115d490613995565b60ff1660ff1681525050600191506115f4565b8080600101915050611490565b5080156116035750505061178d565b818b8981518110611617576116166135d1565b5b60200260200101515f019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff1681525050896001015f9054906101000a900461ffff1661ffff1667ffffffffffffffff81111561168357611682612f09565b5b6040519080825280602002602001820160405280156116b15781602001602082028036833780820191505090505b508b89815181106116c5576116c46135d1565b5b602002602001015160200181905250828b89815181106116e8576116e76135d1565b5b6020026020010151602001515f81518110611706576117056135d1565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250506001898981518110611767576117666135d1565b5b602002602001019060ff16908160ff1681525050878061178690613942565b9850505050505b80806001019150506113f8565b505080806117a790613942565b9150506113c2565b505f5b8281101561180f575f8482815181106117ce576117cd6135d1565b5b602002602001015160ff1690505f8783815181106117ef576117ee6135d1565b5b6020026020010151602001519050818152505080806001019150506117b2565b508185525050505090565b5f808290505f8173ffffffffffffffffffffffffffffffffffffffff16636e25b9786040518163ffffffff1660e01b81526004015f60405180830381865afa158015611868573d5f803e3d5ffd5b505050506040513d5f823e3d601f19601f8201168201806040525081019061189091906138c5565b905061189c8482610de1565b92505050919050565b806118ae611e8a565b6003015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b60605f6118fc611e8a565b9050806001015f9054906101000a900461ffff1661ffff1667ffffffffffffffff81111561192d5761192c612f09565b5b60405190808252806020026020018201604052801561195b5781602001602082028036833780820191505090505b5091505f805f5b836001015f9054906101000a900461ffff1661ffff16821015611aee575f846002015f8381526020019081526020015f205490505f5b6008811015611ad95783806119ac90613942565b945050856001015f9054906101000a900461ffff1661ffff168411611ad9575f600582901b83901b9050865f015f827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205460601c73ffffffffffffffffffffffffffffffffffffffff168973ffffffffffffffffffffffffffffffffffffffff1603611acb5780888781518110611a7057611a6f6135d1565b5b60200260200101907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815250508580611ac790613942565b9650505b508080600101915050611998565b50508080611ae690613942565b915050611962565b50818452505050919050565b5f805f9050611b07612c1e565b84815f019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250508181602001906002811115611b5657611b556135fe565b5b90816002811115611b6a57611b696135fe565b5b815250508381604001819052505f600167ffffffffffffffff811115611b9357611b92612f09565b5b604051908082528060200260200182016040528015611bcc57816020015b611bb9612c1e565b815260200190600190039081611bb15790505b50905081815f81518110611be357611be26135d1565b5b60200260200101819052505f6060611bfc838383610bb6565b60019550505050505092915050565b5f8060029050611c19612c1e565b5f606081835f019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250508383602001906002811115611c6b57611c6a6135fe565b5b90816002811115611c7f57611c7e6135fe565b5b815250508583604001819052505f600167ffffffffffffffff811115611ca857611ca7612f09565b5b604051908082528060200260200182016040528015611ce157816020015b611cce612c1e565b815260200190600190039081611cc65790505b50905083815f81518110611cf857611cf76135d1565b5b6020026020010181905250611d0e818484610bb6565b600195505050505050919050565b5f611d25611e8a565b5f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205460601c9050919050565b611d8881612bbb565b50565b5f805f7f177481ac65e4292921c69f62d1cc7f57541261e5d61c8175cf4e36a01c9bfc939050809150815f015f80357fffffffff00000000000000000000000000000000000000000000000000000000167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205460601c9250505090565b5f807ffc606c433378e3a7e0a6a531deac289b66caa1b4aa8554fd4ab2c6f1570f92d890508091505090565b5f807f8a22373512790c48b83a1fe2efdd2888d4a917bcdc24d0adf63e60f67168046090508091505090565b5f807f177481ac65e4292921c69f62d1cc7f57541261e5d61c8175cf4e36a01c9bfc9390508091505090565b5f80611eda835f015173ffffffffffffffffffffffffffffffffffffffff1661051c565b15611f4c573073ffffffffffffffffffffffffffffffffffffffff16835f015173ffffffffffffffffffffffffffffffffffffffff1603611f47576040517fe983573100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b611fb5565b3073ffffffffffffffffffffffffffffffffffffffff16835f015173ffffffffffffffffffffffffffffffffffffffff1614611fb4576040517ff77172ac00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5b5f5b8360400151518110156121ac575f84604001518281518110611fdc57611fdb6135d1565b5b602002602001015190505f885f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205490505f73ffffffffffffffffffffffffffffffffffffffff168160601c73ffffffffffffffffffffffffffffffffffffffff16146120a2576040517f92474ee200000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b875f1b865f015160601b6bffffffffffffffffffffffff191617895f015f847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f20819055505f600560078a16901b905080837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916901c817fffffffff000000000000000000000000000000000000000000000000000000005f1b901c19891617975060e0810361219457878a6002015f60038c901c81526020019081526020015f20819055505f801b97505b88806001019950505050508080600101915050611fb7565b5084849150915094509492505050565b6121de815f015173ffffffffffffffffffffffffffffffffffffffff1661051c565b612214576040517ff77172ac00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f5b81604001515181101561245e575f8260400151828151811061223b5761223a6135d1565b5b602002602001015190505f845f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205490505f8160601c90505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603612305576040517f6fc4b52e00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b3073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff160361236a576040517fe983573100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b845f015173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036123d2576040517f617557e600000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b845f015160601b6bffffffffffffffffffffffff19166bffffffffffffffffffffffff5f1b831617865f015f857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f20819055505050508080600101915050612216565b505050565b5f805f73ffffffffffffffffffffffffffffffffffffffff16835f015173ffffffffffffffffffffffffffffffffffffffff16146124cd576040517feacd242400000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f600386901c90505f6007871690505f5b856040015151811015612904575f86604001518281518110612503576125026135d1565b5b602002602001015190505f8a5f015f837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205490505f73ffffffffffffffffffffffffffffffffffffffff168160601c73ffffffffffffffffffffffffffffffffffffffff16036125c9576040517f6fc4b52e00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b3073ffffffffffffffffffffffffffffffffffffffff168160601c73ffffffffffffffffffffffffffffffffffffffff1603612631576040517fe983573100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f801b8903612662578480600190039550508a6002015f8681526020019081526020015f205498506007935061266c565b8380600190039450505b5f805f600587901b8c901b9250847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614612785578d5f015f847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f20546bffffffffffffffffffffffff19166bffffffffffffffffffffffff5f1b8516178e5f015f857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f20819055505b8d5f015f867bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020019081526020015f205f90555f845f1c61ffff169050600381901c9250600560078216901b91505087821461287f575f8e6002015f8481526020019081526020015f2054905081847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916901c827fffffffff000000000000000000000000000000000000000000000000000000005f1b901c198216179050808f6002015f8581526020019081526020015f2081905550506128cf565b80837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916901c817fffffffff000000000000000000000000000000000000000000000000000000005f1b901c198d16179b505b5f87036128f2578d6002015f8981526020019081526020015f205f90555f801b9b505b505050505080806001019150506124de565b5080600383901b179650868693509350505094509492505050565b5f81511415155f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161415151461298d576040517f26df4ccd00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614612abf573073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614612a4957612a128273ffffffffffffffffffffffffffffffffffffffff1661051c565b612a48576040517ff77172ac00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5b5f8273ffffffffffffffffffffffffffffffffffffffff1682604051612a6f91906139f7565b5f60405180830381855af49150503d805f8114612aa7576040519150601f19603f3d011682016040523d82523d5f602084013e612aac565b606091505b5050905080612abd573d5f803e3d5ffd5b505b5050565b5f807f24aa1f7b31fd188a8d3ecfb06bc55c806040e59b03bd4396283442fce661789090508091505090565b5f612af8611e5e565b90508173ffffffffffffffffffffffffffffffffffffffff16815f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a381815f015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505050565b612bc481612bc7565b50565b612bd081612bd3565b50565b80612bdc612ac3565b5f015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b60405180606001604052805f73ffffffffffffffffffffffffffffffffffffffff1681526020015f6002811115612c5857612c576135fe565b5b8152602001606081525090565b60405180604001604052805f73ffffffffffffffffffffffffffffffffffffffff168152602001606081525090565b5f604051905090565b5f80fd5b5f80fd5b5f7fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b612cd981612ca5565b8114612ce3575f80fd5b50565b5f81359050612cf481612cd0565b92915050565b5f60208284031215612d0f57612d0e612c9d565b5b5f612d1c84828501612ce6565b91505092915050565b5f8115159050919050565b612d3981612d25565b82525050565b5f602082019050612d525f830184612d30565b92915050565b5f80fd5b5f80fd5b5f80fd5b5f8083601f840112612d7957612d78612d58565b5b8235905067ffffffffffffffff811115612d9657612d95612d5c565b5b602083019150836020820283011115612db257612db1612d60565b5b9250929050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f612de282612db9565b9050919050565b612df281612dd8565b8114612dfc575f80fd5b50565b5f81359050612e0d81612de9565b92915050565b5f8083601f840112612e2857612e27612d58565b5b8235905067ffffffffffffffff811115612e4557612e44612d5c565b5b602083019150836001820283011115612e6157612e60612d60565b5b9250929050565b5f805f805f60608688031215612e8157612e80612c9d565b5b5f86013567ffffffffffffffff811115612e9e57612e9d612ca1565b5b612eaa88828901612d64565b95509550506020612ebd88828901612dff565b935050604086013567ffffffffffffffff811115612ede57612edd612ca1565b5b612eea88828901612e13565b92509250509295509295909350565b5f601f19601f8301169050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b612f3f82612ef9565b810181811067ffffffffffffffff82111715612f5e57612f5d612f09565b5b80604052505050565b5f612f70612c94565b9050612f7c8282612f36565b919050565b5f67ffffffffffffffff821115612f9b57612f9a612f09565b5b602082029050602081019050919050565b5f612fbe612fb984612f81565b612f67565b90508083825260208201905060208402830185811115612fe157612fe0612d60565b5b835b8181101561300a5780612ff68882612ce6565b845260208401935050602081019050612fe3565b5050509392505050565b5f82601f83011261302857613027612d58565b5b8135613038848260208601612fac565b91505092915050565b5f806040838503121561305757613056612c9d565b5b5f61306485828601612dff565b925050602083013567ffffffffffffffff81111561308557613084612ca1565b5b61309185828601613014565b9150509250929050565b5f602082840312156130b0576130af612c9d565b5b5f6130bd84828501612dff565b91505092915050565b6130cf81612dd8565b82525050565b5f6020820190506130e85f8301846130c6565b92915050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b61312081612dd8565b82525050565b5f6131318383613117565b60208301905092915050565b5f602082019050919050565b5f613153826130ee565b61315d81856130f8565b935061316883613108565b805f5b8381101561319857815161317f8882613126565b975061318a8361313d565b92505060018101905061316b565b5085935050505092915050565b5f6020820190508181035f8301526131bd8184613149565b905092915050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b61322081612ca5565b82525050565b5f6132318383613217565b60208301905092915050565b5f602082019050919050565b5f613253826131ee565b61325d81856131f8565b935061326883613208565b805f5b8381101561329857815161327f8882613226565b975061328a8361323d565b92505060018101905061326b565b5085935050505092915050565b5f604083015f8301516132ba5f860182613117565b50602083015184820360208601526132d28282613249565b9150508091505092915050565b5f6132ea83836132a5565b905092915050565b5f602082019050919050565b5f613308826131c5565b61331281856131cf565b935083602082028501613324856131df565b805f5b8581101561335f578484038952815161334085826132df565b945061334b836132f2565b925060208a01995050600181019050613327565b50829750879550505050505092915050565b5f6020820190508181035f83015261338981846132fe565b905092915050565b5f82825260208201905092915050565b5f6133ab826131ee565b6133b58185613391565b93506133c083613208565b805f5b838110156133f05781516133d78882613226565b97506133e28361323d565b9250506001810190506133c3565b5085935050505092915050565b5f6020820190508181035f83015261341581846133a1565b905092915050565b5f6020828403121561343257613431612c9d565b5b5f82013567ffffffffffffffff81111561344f5761344e612ca1565b5b61345b84828501613014565b91505092915050565b5f67ffffffffffffffff82111561347e5761347d612f09565b5b602082029050602081019050919050565b5f80fd5b5f80fd5b600381106134a3575f80fd5b50565b5f813590506134b481613497565b92915050565b5f606082840312156134cf576134ce61348f565b5b6134d96060612f67565b90505f6134e884828501612dff565b5f8301525060206134fb848285016134a6565b602083015250604082013567ffffffffffffffff81111561351f5761351e613493565b5b61352b84828501613014565b60408301525092915050565b5f61354961354484613464565b612f67565b9050808382526020820190506020840283018581111561356c5761356b612d60565b5b835b818110156135b357803567ffffffffffffffff81111561359157613590612d58565b5b80860161359e89826134ba565b8552602085019450505060208101905061356e565b5050509392505050565b5f6135c9368484613537565b905092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602160045260245ffd5b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b60038110613665576136646135fe565b5b50565b5f81905061367582613654565b919050565b5f61368482613668565b9050919050565b6136948161367a565b82525050565b5f606083015f8301516136af5f860182613117565b5060208301516136c2602086018261368b565b50604083015184820360408601526136da8282613249565b9150508091505092915050565b5f6136f2838361369a565b905092915050565b5f602082019050919050565b5f6137108261362b565b61371a8185613635565b93508360208202850161372c85613645565b805f5b85811015613767578484038952815161374885826136e7565b9450613753836136fa565b925060208a0199505060018101905061372f565b50829750879550505050505092915050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f6137ab82613779565b6137b58185613783565b93506137c5818560208601613793565b6137ce81612ef9565b840191505092915050565b5f6060820190508181035f8301526137f18186613706565b905061380060208301856130c6565b818103604083015261381281846137a1565b9050949350505050565b5f8151905061382a81612cd0565b92915050565b5f61384261383d84612f81565b612f67565b9050808382526020820190506020840283018581111561386557613864612d60565b5b835b8181101561388e578061387a888261381c565b845260208401935050602081019050613867565b5050509392505050565b5f82601f8301126138ac576138ab612d58565b5b81516138bc848260208601613830565b91505092915050565b5f602082840312156138da576138d9612c9d565b5b5f82015167ffffffffffffffff8111156138f7576138f6612ca1565b5b61390384828501613898565b91505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f819050919050565b5f61394c82613939565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff820361397e5761397d61390c565b5b600182019050919050565b5f60ff82169050919050565b5f61399f82613989565b915060ff82036139b2576139b161390c565b5b600182019050919050565b5f81905092915050565b5f6139d182613779565b6139db81856139bd565b93506139eb818560208601613793565b80840191505092915050565b5f613a0282846139c7565b91508190509291505056fea2646970667358221220a040bb1397c5fe58ac8679196971af9fbb87b8eb5e5766071bddbc41b23e50e364736f6c63430008190033a26469706673582212200182586ca7ae9ad76c91ac23b86ffc2b14674e4f632ac3576dbb2ffdd628184664736f6c63430008190033",
            confirmations: 1n,
            chainId: 137n
        }).receipt()).unwrap()!).contractAddress!;
        const authPlugInAddress: string = await this._deploy("src/app/atlas/sol/class/misc/auth/AuthPlugIn.sol");
        const tokenPlugInAddress: string = await this._deploy("src/app/atlas/sol/class/misc/token/TokenPlugIn.sol");
        const tokenSetterPlugInAddress: string = await this._deploy("src/app/atlas/sol/class/misc/token/TokenSetterPlugIn.sol");
        const tokenMintPlugInAddress: string = await this._deploy("src/app/atlas/sol/class/misc/token/TokenMintPlugIn.sol");
        const tokenBurnPlugInAddress: string = await this._deploy("src/app/atlas/sol/class/misc/token/TokenBurnPlugIn.sol");
        const routerPlugInAddress: string = await this._deploy("src/app/atlas/sol/class/kernel/router/RouterPlugIn.sol");
        const adminNodePlugInAddress: string = await this._deploy("src/app/atlas/sol/class/kernel/adminNode/AdminNodePlugIn.sol");
        const kernelNodeAddress: string = await this._deploy("src/app/atlas/sol/Node.sol");
        await this._install(kernelNodeAddress, authPlugInAddress);
        await this._install(kernelNodeAddress, tokenPlugInAddress);
        await this._install(kernelNodeAddress, tokenSetterPlugInAddress);
        await this._install(kernelNodeAddress, tokenMintPlugInAddress);
        await this._install(kernelNodeAddress, tokenBurnPlugInAddress);
        await this._install(kernelNodeAddress, routerPlugInAddress);
        await this._install(kernelNodeAddress, adminNodePlugInAddress);
        await this._claimOwnership(kernelNodeAddress);
        await this._commit(kernelNodeAddress, "NodeDeployer", nodeDeployerAddress);
        await this._commit(kernelNodeAddress, "AuthPlugIn", authPlugInAddress);
        await this._commit(kernelNodeAddress, "TokenPlugIn", tokenPlugInAddress);
        await this._commit(kernelNodeAddress, "TokenSetterPlugIn", tokenSetterPlugInAddress);
        await this._commit(kernelNodeAddress, "TokenMintPlugIn", tokenMintPlugInAddress);
        await this._commit(kernelNodeAddress, "TokenBurnPlugIn", tokenBurnPlugInAddress);
        await this._commit(kernelNodeAddress, "RouterPlugIn", routerPlugInAddress);
        await this._commit(kernelNodeAddress, "AdminNodePlugIn", adminNodePlugInAddress);
        console.log("NodeDeployer", nodeDeployerAddress);
        console.log("AuthPlugIn", authPlugInAddress);
        console.log("TokenPlugIn", tokenPlugInAddress);
        console.log("TokenSetterPlugIn", tokenSetterPlugInAddress);
        console.log("TokenMintPlugIn", tokenMintPlugInAddress);
        console.log("TokenBurnPlugIn", tokenBurnPlugInAddress);
        console.log("RouterPlugIn", routerPlugInAddress);
        console.log("AdminNodePlugIn", adminNodePlugInAddress);
        console.log("KernelNode", kernelNodeAddress);
    }

    protected static async _deploy(solFilePath: string): Promise<string> {
        return ((await new Host.ConstructorTransaction({
            rpcUrl: this._rpcUrl,
            privateKey: this._privateKey.resolve().unwrap(),
            gasPrice: "standard",
            bytecode: new Host.SolFile(new Host.Path(solFilePath)),
            confirmations: 1n,
            chainId: 137n
        }).receipt()).unwrap()!).contractAddress!;
    }

    protected static async _install(kernelNodeAddress: string, plugInAddress: string): Promise<string | undefined> {
        return ((await new Host.Transaction({
            rpcUrl: this._rpcUrl,
            privateKey: this._privateKey.resolve().unwrap(),
            gasPrice: "standard",
            methodSignature: "function install(address) external returns (bool)",
            methodName: "install",
            methodArgs: [
                plugInAddress
            ],
            to: kernelNodeAddress,
            confirmations: 1n,
            chainId: 137n,
            value: 0n
        }).receipt()).unwrap())?.hash;
    }

    protected static async _commit(kernelNodeAddress: string, repoName: string, implementationAddress: string) {
        return ((await new Host.Transaction({
            rpcUrl: this._rpcUrl,
            privateKey: this._privateKey.resolve().unwrap(),
            gasPrice: "standard",
            methodSignature: "function commit(string,address) external returns (bool)",
            methodName: "commit",
            methodArgs: [
                repoName,
                implementationAddress
            ],
            to: kernelNodeAddress,
            confirmations: 1n,
            chainId: 137n,
            value: 0n
        }).receipt()).unwrap())?.hash;
    }

    protected static async _claimOwnership(kernelNodeAddress: string) {
        return ((await new Host.Transaction({
            rpcUrl: this._rpcUrl,
            privateKey: this._privateKey.resolve().unwrap(),
            gasPrice: "standard",
            methodSignature: "function claimOwnership() external returns (bool)",
            methodName: "claimOwnership",
            to: kernelNodeAddress,
            confirmations: 1n,
            chainId: 137n,
            value: 0n
        }).receipt()).unwrap())?.hash;
    }
}

KernelSetUpScript.run();